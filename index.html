<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Korndog Cosmic Drift (Locked Night Build)</title>

  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <style>
    html, body {
      margin: 0;
      height: 100%;
      background: #000;
      overflow: hidden;
    }

    .hud {
      position: fixed;
      left: 12px;
      bottom: 10px;
      z-index: 10;
      font: 14px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color: rgba(255,255,255,.85);
      text-shadow: 0 2px 10px rgba(0,0,0,.75);
      user-select: none;
      pointer-events: none;
      padding: 6px 10px;
      border-radius: 12px;
      background: rgba(0,0,0,.20);
      backdrop-filter: blur(3px);
    }

    .a-enter-vr-button {
      border-radius: 14px !important;
    }
  </style>
</head>

<body>
  <div class="hud">
    Auto background swap • 45s sky drift • Planets 20s spin • unclumped (rig-locked)
  </div>

  <a-scene
    vr-mode-ui="enabled: true"
    renderer="colorManagement: true; physicallyCorrectLights: true; antialias: true"
    background="color: #000"
  >

    <!-- CAMERA -->
    <a-entity id="rig" position="0 1.6 0">
      <a-camera
        wasd-controls-enabled="false"
        look-controls="pointerLockEnabled: false"
        fov="78"
      ></a-camera>
    </a-entity>

    <!-- LIGHTING -->
    <a-entity light="type: ambient; intensity: 0.55; color: #ffffff"></a-entity>
    <a-entity light="type: directional; intensity: 0.95; color: #ffffff" position="2 4 3"></a-entity>

    <!-- ASSETS -->
    <a-assets>
      <!-- 2 sky JPGs -->
      <img id="skyAimg" src="space-background-realistic-starry-night-cosmos-shining-stars-milky-way-stardust-color-galaxy.jpg" crossorigin="anonymous">
      <img id="skyBimg" src="space-background-realistic-starry-night-cosmos-shining-stars-milky-way-stardust-color-galaxy (1).jpg" crossorigin="anonymous">

      <!-- planet textures -->
      <img id="texEarth"   src="earth_tex.jpg"   crossorigin="anonymous">
      <img id="texJupiter" src="jupiter_tex.jpg" crossorigin="anonymous">
      <img id="texUranus"  src="uranus_tex.jpg"  crossorigin="anonymous">
      <img id="texMoon"    src="moon_tex.jpg"    crossorigin="anonymous">
      <img id="texSaturn"  src="saturn_tex.jpg"  crossorigin="anonymous">
    </a-assets>

    <!--
      SKY RIG (THIS is what moves)
      - We rotate the rig, not the sky layers.
      - Crossfade swaps stay stable on mobile/Quest.
    -->
    <a-entity id="skyRig" rotation="0 0 0">
      <a-sky id="skyLayerA"
        src="#skyAimg"
        rotation="0 0 0"
        material="shader: flat; transparent: true; opacity: 1.0; side: back"
      ></a-sky>

      <a-sky id="skyLayerB"
        src="#skyBimg"
        rotation="0 0 0"
        material="shader: flat; transparent: true; opacity: 0.0; side: back"
      ></a-sky>
    </a-entity>

    <!--
      PLANETS (WIDER SPREAD + MORE DEPTH)
      Notes:
      - Wider X range so they don’t stack in the same band.
      - More Z variation so the scene has depth.
      - More Y variation so they don’t line up like a parade float.
    -->

    <!-- Far left / deep -->
    <a-sphere id="moon"
      radius="0.42"
      position="-11.0 3.6 -18.0"
      material="src: #texMoon; roughness: 1.0; metalness: 0.0"
      animation="property: rotation; to: 0 360 0; dur: 20000; easing: linear; loop: true"
    ></a-sphere>

    <!-- Left / mid -->
    <a-sphere id="earth"
      radius="0.60"
      position="-6.2 1.2 -11.0"
      material="src: #texEarth; roughness: 0.95; metalness: 0.0"
      animation="property: rotation; to: 0 360 0; dur: 20000; easing: linear; loop: true"
    ></a-sphere>

    <!-- Center / nearer -->
    <a-sphere id="jupiter"
      radius="0.95"
      position="0.0 2.7 -9.0"
      material="src: #texJupiter; roughness: 0.9; metalness: 0.0"
      animation="property: rotation; to: 0 360 0; dur: 20000; easing: linear; loop: true"
    ></a-sphere>

    <!-- Right / deeper -->
    <a-sphere id="uranus"
      radius="0.70"
      position="7.0 1.9 -15.5"
      material="src: #texUranus; roughness: 0.9; metalness: 0.0"
      animation="property: rotation; to: 0 360 0; dur: 20000; easing: linear; loop: true"
    ></a-sphere>

    <!-- Far right / mid -->
    <a-sphere id="saturn"
      radius="0.85"
      position="12.0 3.2 -12.5"
      material="src: #texSaturn; roughness: 0.9; metalness: 0.0"
      animation="property: rotation; to: 0 360 0; dur: 20000; easing: linear; loop: true"
    ></a-sphere>

    <!-- Saturn rings -->
    <a-ring
      position="12.0 3.2 -12.5"
      rotation="75 0 0"
      radius-inner="1.05"
      radius-outer="1.55"
      material="color: #c9b8a6; opacity: 0.35; transparent: true; side: double"
    ></a-ring>

    <!-- SCRIPT: sky drift + crossfade swap (stable on Quest/mobile) -->
    <script>
      (function () {
        const SKY_DRIFT_MS = 45000;  // visible drift speed
        const SKY_SWAP_MS  = 45000;  // background auto swap
        const FADE_MS      = 1600;   // crossfade time

        const skyRig = document.getElementById('skyRig');
        const skyA = document.getElementById('skyLayerA');
        const skyB = document.getElementById('skyLayerB');

        let showingA = true;

        // ✅ Drift on the RIG so it cannot get stomped by crossfades
        // Increase Y rotation enough to be visible (12 degrees sweep)
        skyRig.setAttribute('animation__drift', {
          property: 'rotation',
          dir: 'alternate',
          dur: SKY_DRIFT_MS,
          easing: 'linear',
          loop: true,
          from: '0 0 0',
          to:   '0 12 0'
        });

        function fade(inEl, outEl) {
          // Fade IN
          inEl.setAttribute('animation__fadein', {
            property: 'material.opacity',
            from: 0.0,
            to: 1.0,
            dur: FADE_MS,
            easing: 'easeInOutQuad'
          });

          // Fade OUT
          outEl.setAttribute('animation__fadeout', {
            property: 'material.opacity',
            from: 1.0,
            to: 0.0,
            dur: FADE_MS,
            easing: 'easeInOutQuad'
          });
        }

        function swapSky() {
          if (showingA) fade(skyB, skyA);
          else fade(skyA, skyB);
          showingA = !showingA;
        }

        setInterval(swapSky, SKY_SWAP_MS);
      })();
    </script>

  </a-scene>
</body>
</html>

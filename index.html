<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>KornDog Galaxy VR</title>

  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <style>
    html, body { margin:0; height:100%; background:#000; overflow:hidden; }
    .hud {
      position: fixed;
      left: 14px; right: 14px; bottom: 18px;
      font: 14px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color: rgba(255,255,255,.85);
      text-shadow: 0 2px 10px rgba(0,0,0,.7);
      z-index: 10;
      pointer-events: none;
    }
    .hud b { color:#fff; }
    .vrbtn {
      position: fixed;
      right: 14px; bottom: 14px;
      z-index: 11;
      pointer-events: auto;
      padding: 10px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.25);
      background: rgba(0,0,0,.45);
      color: #fff;
      font-weight: 700;
      letter-spacing: .3px;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }
  </style>
</head>

<body>
  <div class="hud">
    <b>Deep space float</b> 路 Milky Way 路 5 planets 路 nebula drift 路 (tap sky to switch)
  </div>
  <button class="vrbtn" id="vrBtn">VR</button>

  <a-scene
    renderer="colorManagement: true; physicallyCorrectLights: true;"
    background="color: #000"
    vr-mode-ui="enabled: false"
    embedded
  >
    <a-assets timeout="20000">
      <!-- SKY IMAGES (your two photos) -->
      <img id="sky1" src="space-background-realistic-starry-night-cosmos-shining-stars-milky-way-stardust-color-galaxy.jpg">
      <img id="sky2" src="space-background-realistic-starry-night-cosmos-shining-stars-milky-way-stardust-color-galaxy (1).jpg">

      <!-- PLANET TEXTURES (the *_tex.jpg files) -->
      <img id="texEarth"  src="earth_tex.jpg">
      <img id="texJupiter" src="jupiter_tex.jpg">
      <img id="texSaturn" src="saturn_tex.jpg">
      <img id="texUranus" src="uranus_tex.jpg">
      <img id="texMoon" src="moon_tex.jpg">
    </a-assets>

    <!-- Camera rig (keep stable for comfort) -->
    <a-entity id="rig" position="0 1.6 0">
      <a-camera
        look-controls="reverseMouseDrag: false"
        wasd-controls-enabled="false"
      ></a-camera>
    </a-entity>

    <!-- Subtle lighting so textures look better -->
    <a-entity light="type: ambient; intensity: 0.75"></a-entity>
    <a-entity light="type: directional; intensity: 0.55" position="2 3 1"></a-entity>

    <!-- SKY: rotates + micro-drift so it feels alive -->
    <a-sky
      id="galaxySky"
      src="#sky1"
      material="shader: flat; side: back; transparent: true; opacity: 1"
      rotation="0 0 0"
      animation__spin="property: rotation; to: 0 360 0; loop: true; dur: 180000; easing: linear"
      animation__wobble="property: rotation; dir: alternate; to: 2 0 -2; loop: true; dur: 22000; easing: easeInOutSine"
    ></a-sky>

    <!-- Planet system: spread around you + drift/orbit -->
    <a-entity id="planetSystem" position="0 1.2 -6" cosmic-drift>

      <!-- EARTH -->
      <a-entity class="p" id="pEarth" position="-6 0.7 -8"
        animation__bob="property: position; dir: alternate; to: -6 1.15 -8; loop: true; dur: 8000; easing: easeInOutSine"
        animation__spin="property: rotation; to: 0 360 0; loop: true; dur: 26000; easing: linear">
        <a-sphere radius="1.05" segments-height="64" segments-width="64"
          material="src: #texEarth; metalness: 0.05; roughness: 0.95"></a-sphere>
      </a-entity>

      <!-- JUPITER -->
      <a-entity class="p" id="pJupiter" position="6 1.0 -10"
        animation__bob="property: position; dir: alternate; to: 6 1.35 -10; loop: true; dur: 9000; easing: easeInOutSine"
        animation__spin="property: rotation; to: 0 360 0; loop: true; dur: 18000; easing: linear">
        <a-sphere radius="1.55" segments-height="64" segments-width="64"
          material="src: #texJupiter; metalness: 0.04; roughness: 0.95"></a-sphere>
      </a-entity>

      <!-- SATURN (sphere + separate ring) -->
      <a-entity class="p" id="pSaturn" position="2.5 0.35 -6"
        rotation="10 0 -10"
        animation__bob="property: position; dir: alternate; to: 2.5 0.75 -6; loop: true; dur: 7800; easing: easeInOutSine"
        animation__spin="property: rotation; to: 10 360 -10; loop: true; dur: 22000; easing: linear">
        <a-sphere radius="1.05" segments-height="64" segments-width="64"
          material="src: #texSaturn; metalness: 0.05; roughness: 0.95"></a-sphere>

        <!-- Ring (simple, looks good in VR) -->
        <a-ring radius-inner="1.25" radius-outer="2.1"
          rotation="75 0 0"
          material="color: #d8c3a3; opacity: 0.55; transparent: true; side: double"></a-ring>
      </a-entity>

      <!-- URANUS -->
      <a-entity class="p" id="pUranus" position="-2.5 0.1 -5"
        rotation="0 0 20"
        animation__bob="property: position; dir: alternate; to: -2.5 0.55 -5; loop: true; dur: 8200; easing: easeInOutSine"
        animation__spin="property: rotation; to: 0 360 20; loop: true; dur: 24000; easing: linear">
        <a-sphere radius="1.15" segments-height="64" segments-width="64"
          material="src: #texUranus; metalness: 0.04; roughness: 0.95"></a-sphere>
      </a-entity>

      <!-- MOON -->
      <a-entity class="p" id="pMoon" position="-1.0 1.25 -3.7"
        animation__bob="property: position; dir: alternate; to: -1.0 1.45 -3.7; loop: true; dur: 5200; easing: easeInOutSine"
        animation__spin="property: rotation; to: 0 360 0; loop: true; dur: 14000; easing: linear">
        <a-sphere radius="0.55" segments-height="64" segments-width="64"
          material="src: #texMoon; metalness: 0.02; roughness: 0.98"></a-sphere>
      </a-entity>

    </a-entity>

    <!-- Shooting stars: rare + short, not spammy -->
    <a-entity id="shootingStars" shooting-stars="minInterval: 14000; maxInterval: 28000; maxAlive: 1;"></a-entity>

    <script>
      // --- VR button ---
      const sceneEl = document.querySelector('a-scene');
      document.getElementById('vrBtn').addEventListener('click', () => sceneEl.enterVR());

      // --- Background switching with fade (tap sky OR auto) ---
      const sky = document.querySelector('#galaxySky');
      let usingSky1 = true;

      function swapSky() {
        // fade out
        sky.setAttribute('animation__fadeout', {
          property: 'material.opacity', to: 0, dur: 1200, easing: 'easeInOutQuad'
        });

        setTimeout(() => {
          sky.setAttribute('src', usingSky1 ? '#sky2' : '#sky1');
          usingSky1 = !usingSky1;
          // fade in
          sky.setAttribute('animation__fadein', {
            property: 'material.opacity', to: 1, dur: 1400, easing: 'easeInOutQuad'
          });
        }, 1200);
      }

      // Tap sky to switch
      sky.addEventListener('click', swapSky);

      // Auto-switch every 75 seconds (tweak if you want faster/slower)
      setInterval(swapSky, 75000);

      // --- Cosmic drift component: gentle orbit + parallax motion ---
      AFRAME.registerComponent('cosmic-drift', {
        schema: {
          orbitSpeed: {default: 0.0022},   // orbiting the whole system
          swaySpeed:  {default: 0.0009},   // subtle side drift
          swayAmt:    {default: 0.55},     // how far the group drifts
          pulseAmt:   {default: 0.18}      // tiny push/pull
        },
        init: function () {
          this.t = 0;
          this.base = this.el.object3D.position.clone();
        },
        tick: function (time, dt) {
          const d = dt || 16;
          this.t += d;

          // orbit the entire system around a point (slow)
          this.el.object3D.rotation.y += this.data.orbitSpeed * d;

          // gentle drift in position (parallax feel)
          const s = Math.sin(this.t * this.data.swaySpeed);
          const c = Math.cos(this.t * (this.data.swaySpeed * 0.83));
          const p = Math.sin(this.t * (this.data.swaySpeed * 0.55));

          this.el.object3D.position.x = this.base.x + s * this.data.swayAmt;
          this.el.object3D.position.z = this.base.z + c * this.data.swayAmt;
          this.el.object3D.position.y = this.base.y + p * this.data.pulseAmt;
        }
      });

      // --- Shooting stars (rare, AC-style) ---
      AFRAME.registerComponent('shooting-stars', {
        schema: {
          minInterval: {default: 12000},
          maxInterval: {default: 24000},
          maxAlive:    {default: 1}
        },
        init: function () {
          this.alive = 0;
          this.scheduleNext();
        },
        scheduleNext: function () {
          const {minInterval, maxInterval} = this.data;
          const wait = Math.floor(minInterval + Math.random() * (maxInterval - minInterval));
          setTimeout(() => this.spawn(), wait);
        },
        spawn: function () {
          if (this.alive >= this.data.maxAlive) { this.scheduleNext(); return; }
          this.alive++;

          const star = document.createElement('a-entity');

          // start somewhere high and far, sweep across view
          const startX = (Math.random() * 18) - 9;
          const startY = 6 + Math.random() * 3.5;
          const startZ = -12 - Math.random() * 8;

          const endX = startX + (Math.random() * 10 + 8) * (Math.random() < 0.5 ? -1 : 1);
          const endY = startY - (Math.random() * 2 + 1.5);
          const endZ = startZ + (Math.random() * 6 + 5);

          star.setAttribute('position', `${startX} ${startY} ${startZ}`);

          // a thin streak (cylinder) rotated to look like a trail
          star.setAttribute('geometry', 'primitive: cylinder; radius: 0.02; height: 1.6;');
          star.setAttribute('material', 'color: #ffffff; emissive: #ffffff; emissiveIntensity: 0.9; opacity: 0.95; transparent: true;');
          star.setAttribute('rotation', `0 0 ${Math.random() * 40 - 20}`);

          // move + fade out
          star.setAttribute('animation__move', {
            property: 'position',
            to: `${endX} ${endY} ${endZ}`,
            dur: 900,
            easing: 'easeOutQuad'
          });
          star.setAttribute('animation__fade', {
            property: 'material.opacity',
            to: 0,
            dur: 900,
            easing: 'easeOutQuad'
          });

          this.el.appendChild(star);

          setTimeout(() => {
            if (star.parentNode) star.parentNode.removeChild(star);
            this.alive--;
            this.scheduleNext();
          }, 950);
        }
      });
    </script>
  </a-scene>
</body>
</html>

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Deep space float • Milky Way • 5 planets • shooting stars</title>

  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <style>
    html, body { margin:0; height:100%; background:#000; overflow:hidden; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    .hint {
      position: fixed;
      left: 14px; right: 14px; bottom: 12px;
      color: rgba(255,255,255,.85);
      font-size: 13px; line-height: 1.35;
      text-shadow: 0 2px 10px rgba(0,0,0,.9);
      pointer-events: none;
      z-index: 10;
    }
    .hint b { color: #fff; }
  </style>

  <script>
    // Slow continuous rotation for anything you attach it to (planets, sky, etc.)
    AFRAME.registerComponent('spin', {
      schema: { speed: {default: 0.4} }, // degrees/sec
      tick: function (t, dt) {
        const r = this.el.object3D.rotation;
        r.y += (this.data.speed * Math.PI/180) * (dt/1000);
      }
    });

    // Adds an axis tilt + spins around its own axis
    AFRAME.registerComponent('axis-spin', {
      schema: {
        tilt: {default: 12},     // degrees
        speed: {default: 0.6}    // degrees/sec
      },
      init: function () {
        const obj = this.el.object3D;
        obj.rotation.z = (this.data.tilt * Math.PI/180);
      },
      tick: function (t, dt) {
        this.el.object3D.rotation.y += (this.data.speed * Math.PI/180) * (dt/1000);
      }
    });

    // Spawns occasional shooting stars across the sky (not too many)
    AFRAME.registerComponent('shooting-stars', {
      schema: {
        minInterval: {default: 5500},  // ms
        maxInterval: {default: 11000}, // ms
        maxAlive:    {default: 2}      // keep it tasteful
      },
      init: function () {
        this.alive = 0;
        this.scheduleNext();
      },
      scheduleNext: function () {
        const wait = this.data.minInterval + Math.random() * (this.data.maxInterval - this.data.minInterval);
        clearTimeout(this._timer);
        this._timer = setTimeout(() => this.spawn(), wait);
      },
      spawn: function () {
        if (this.alive >= this.data.maxAlive) { this.scheduleNext(); return; }

        const scene = this.el.sceneEl;

        // Star streak as a thin plane with emissive-ish look
        const star = document.createElement('a-entity');
        const len = 2.8 + Math.random() * 2.4;     // length
        const thick = 0.05 + Math.random() * 0.03; // thickness

        star.setAttribute('geometry', `primitive: plane; width: ${len}; height: ${thick}`);
        star.setAttribute('material', 'color: #ffffff; opacity: 0.9; transparent: true; shader: flat; side: double');
        star.setAttribute('render-order', '10');

        // Place far away on a big radius around the user
        const radius = 45;
        const startTheta = Math.random() * Math.PI * 2;
        const startPhi = (Math.PI/2) * (0.15 + Math.random()*0.55); // keep it upper-ish
        const x = radius * Math.cos(startTheta) * Math.sin(startPhi);
        const y = radius * Math.cos(startPhi);
        const z = radius * Math.sin(startTheta) * Math.sin(startPhi);

        star.object3D.position.set(x, y, z);

        // Aim it across the sky: random direction, but mostly sideways
        const dirTheta = startTheta + (Math.random() * 0.8 + 0.6); // offset
        const dx = Math.cos(dirTheta);
        const dz = Math.sin(dirTheta);
        const dy = (Math.random()*0.12 - 0.06);

        // Rotate plane to face movement direction
        const angle = Math.atan2(dz, dx);
        star.object3D.rotation.y = -angle;

        scene.appendChild(star);
        this.alive++;

        // Animate: streak across then fade out
        const duration = 900 + Math.random() * 700;

        const start = performance.now();
        const startPos = star.object3D.position.clone();
        const speed = 12 + Math.random()*8;

        const tickMove = () => {
          const now = performance.now();
          const p = Math.min(1, (now - start) / duration);

          star.object3D.position.x = startPos.x + dx * speed * p;
          star.object3D.position.y = startPos.y + dy * speed * p;
          star.object3D.position.z = startPos.z + dz * speed * p;

          // Fade out near the end
          const opacity = p < 0.65 ? 0.9 : (0.9 * (1 - (p - 0.65) / 0.35));
          star.setAttribute('material', `color: #ffffff; opacity: ${Math.max(0, opacity).toFixed(3)}; transparent: true; shader: flat; side: double`);

          if (p < 1) requestAnimationFrame(tickMove);
          else {
            star.parentNode && star.parentNode.removeChild(star);
            this.alive--;
          }
        };

        requestAnimationFrame(tickMove);
        this.scheduleNext();
      },
      remove: function () {
        clearTimeout(this._timer);
      }
    });

    // Slowly rotates a parent group so planets drift around you (motion without head-whipping)
    AFRAME.registerComponent('drift-orbit', {
      schema: { speed: {default: 0.015} }, // radians/sec
      tick: function (t, dt) {
        this.el.object3D.rotation.y += this.data.speed * (dt/1000);
      }
    });
  </script>
</head>

<body>
  <div class="hint">
    <b>Deep space float</b> • Milky Way • 5 planets • nebula motion • shooting stars<br/>
    Move your phone / drag to look • Tap VR when ready
  </div>

  <a-scene
    vr-mode-ui="enabled: true"
    renderer="antialias: true; colorManagement: true; physicallyCorrectLights: true;"
    background="color: #000"
  >
    <a-assets timeout="15000">
      <!-- IMPORTANT:
           If your galaxy background filename is different, change it HERE.
           (This matches the earlier screenshot name without “(1)”.) -->
      <img id="skyTex" src="space-background-realistic-starry-night-cosmos-shining-stars-milky-way-stardust-color-galaxy.jpg" crossorigin="anonymous">

      <img id="earthTex"  src="earth_tex.jpg"  crossorigin="anonymous">
      <img id="jupTex"    src="jupiter_tex.jpg" crossorigin="anonymous">
      <img id="moonTex"   src="moon_tex.jpg"   crossorigin="anonymous">
      <img id="satTex"    src="saturn_tex.jpg" crossorigin="anonymous">
      <img id="uraTex"    src="uranus_tex.jpg" crossorigin="anonymous">
    </a-assets>

    <!-- Sky: rotates slowly for motion -->
    <a-sky src="#skyTex" rotation="0 -90 0" spin="speed: 0.12"></a-sky>

    <!-- Lighting: keeps planets from looking flat -->
    <a-entity light="type: ambient; intensity: 0.55; color: #ffffff"></a-entity>
    <a-entity light="type: directional; intensity: 0.85; color: #ffffff" position="6 10 6"></a-entity>
    <a-entity light="type: point; intensity: 0.35; color: #9bd3ff; distance: 80" position="-10 6 -12"></a-entity>

    <!-- Camera -->
    <a-entity position="0 1.6 0">
      <a-camera wasd-controls-enabled="false" look-controls="pointerLockEnabled: false"></a-camera>
    </a-entity>

    <!-- Shooting stars controller -->
    <a-entity shooting-stars="minInterval: 6000; maxInterval: 12000; maxAlive: 2"></a-entity>

    <!-- Planet field: spread around you + drifting slowly -->
    <a-entity id="planetField" drift-orbit="speed: 0.01">

      <!-- EARTH -->
      <a-sphere
        radius="2.2"
        position="12 2 -18"
        axis-spin="tilt: 23.5; speed: 0.45"
        material="src: #earthTex; shader: standard; metalness: 0.05; roughness: 0.95"
      ></a-sphere>

      <!-- JUPITER -->
      <a-sphere
        radius="3.2"
        position="-18 1 -26"
        axis-spin="tilt: 3.1; speed: 0.32"
        material="src: #jupTex; shader: standard; metalness: 0.02; roughness: 0.98"
      ></a-sphere>

      <!-- SATURN -->
      <a-entity position="22 3 10" rotation="0 35 0">
        <a-sphere
          radius="2.7"
          axis-spin="tilt: 26.7; speed: 0.36"
          material="src: #satTex; shader: standard; metalness: 0.02; roughness: 0.98"
        ></a-sphere>

        <!-- Simple ring (subtle) -->
        <a-ring
          radius-inner="3.2"
          radius-outer="4.7"
          rotation="75 0 0"
          material="color: #d7c9aa; opacity: 0.35; transparent: true; shader: flat; side: double"
        ></a-ring>
      </a-entity>

      <!-- URANUS -->
      <a-sphere
        radius="2.4"
        position="-6 3 18"
        axis-spin="tilt: 97.8; speed: 0.40"
        material="src: #uraTex; shader: standard; metalness: 0.03; roughness: 0.95"
      ></a-sphere>

      <!-- MOON -->
      <a-sphere
        radius="1.4"
        position="2 0.8 26"
        axis-spin="tilt: 6.7; speed: 0.18"
        material="src: #moonTex; shader: standard; metalness: 0.0; roughness: 1.0"
      ></a-sphere>

    </a-entity>

  </a-scene>
</body>
</html>
